from https://github.com/libidn/libidn2/commit/e4d1558aa2c1c04a05066ee8600f37603890ba8c

--- a/lib/lookup.c.~1~	2019-10-29 13:46:14.854473224 +0100
+++ b/lib/lookup.c	2019-10-29 13:50:20.193921225 +0100
@@ -599,8 +599,16 @@
        * char * out  output zero terminated string that must have room for at
        * least 63 characters plus the terminating zero.
        */
+
+      size_t len = strlen ((char *) output_u8);
+
+      if (len > 63)
+        {
+	  free (output_u8);
+	  return IDN2_TOO_BIG_DOMAIN;
+        }
       if (output)
-	strcpy (output, (const char *) output_u8);
+	strcpy (output, (char *) output_u8);
     }
 
   free(output_u8);
