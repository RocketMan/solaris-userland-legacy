commit cbe9f8bd9cfc6c3c87a60fbae58fa1a85db59df0
Author: K.Kosako <kkosako0@gmail.com>
Date:   Mon Sep 21 12:58:29 2020 +0900

    #207: Out-of-bounds write

commit 8155473a2ab783b91e9f5a2e308bb7b5c4fec344
Author: K.Kosako <kkosako0@gmail.com>
Date:   Thu Oct 1 23:16:05 2020 +0900

    #207: Another Out-of-bounds write

diff --git a/src/regcomp.c b/src/regcomp.c
index 69d4b95..0d67886 100644
--- a/src/regcomp.c
+++ b/src/regcomp.c
@@ -5577,7 +5577,7 @@ concat_opt_exact(OptStr* to, OptStr* add, OnigEncoding enc)
   end = p + add->len;
   for (i = to->len; p < end; ) {
     len = enclen(enc, p);
-    if (i + len > OPT_EXACT_MAXLEN) {
+    if (i + len >= OPT_EXACT_MAXLEN) {
       r = 1; /* 1:full */
       break;
     }
@@ -5603,7 +5603,7 @@ concat_opt_exact_str(OptStr* to, UChar* s, UChar* end, OnigEncoding enc)
 
   for (i = to->len, p = s; p < end && i < OPT_EXACT_MAXLEN; ) {
     len = enclen(enc, p);
-    if (i + len > OPT_EXACT_MAXLEN) break;
+    if (i + len >= OPT_EXACT_MAXLEN) break;
     for (j = 0; j < len && p < end; j++)
       to->s[i++] = *p++;
   }
