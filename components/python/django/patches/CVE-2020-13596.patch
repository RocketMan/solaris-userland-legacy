Fixes CVE-2020-13596.
Desc:
  Query parameters for the admin ForeignKeyRawIdWidget were not properly URL
  encoded, posing an XSS attack vector. ForeignKeyRawIdWidget now ensures
  query parameters are correctly URL encoded.

Partially backported from Django master:
https://github.com/django/django/commit/2dd4d110c159d0c81dff42eaead2c378a0998735

--- Django-1.11.29/django/contrib/admin/widgets.py
+++ Django-1.11.29/django/contrib/admin/widgets.py
@@ -14,7 +14,7 @@ from django.urls.exceptions import NoRev
 from django.utils import six
 from django.utils.encoding import force_text
 from django.utils.html import smart_urlquote
-from django.utils.safestring import mark_safe
+from django.utils.http import urlencode
 from django.utils.text import Truncator
 from django.utils.translation import ugettext as _
 
@@ -149,8 +149,8 @@ class ForeignKeyRawIdWidget(forms.TextIn
 
             params = self.url_parameters()
             if params:
-                related_url += '?' + '&amp;'.join('%s=%s' % (k, v) for k, v in params.items())
-            context['related_url'] = mark_safe(related_url)
+                related_url += '?' + urlencode(params)
+            context['related_url'] = related_url
             context['link_title'] = _('Lookup')
             # The JavaScript code looks for this class.
             context['widget']['attrs'].setdefault('class', 'vForeignKeyRawIdAdminField')
