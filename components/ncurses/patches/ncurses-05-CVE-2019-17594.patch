cherry picked from https://github.com/mirror/ncurses/commit/b025434573f466efe27862656a6a9d41dd2bd609
diff -r 46898bc9d70e ncurses/tinfo/comp_hash.c
--- a/ncurses/tinfo/comp_hash.c	Thu Oct 31 09:48:12 2019 +0100
+++ b/ncurses/tinfo/comp_hash.c	Thu Oct 31 11:46:27 2019 +0100
@@ -63,8 +63,9 @@
 
     hashvalue = data->hash_of(string);
 
-    if (data->table_data[hashvalue] >= 0) {
-
+    if (hashvalue >= 0
+      && (unsigned) hashvalue < data->table_size
+      && data->table_data[hashvalue] >= 0) {
 	real_table = _nc_get_table(termcap);
 	ptr = real_table + data->table_data[hashvalue];
 	while (!data->compare_names(ptr->nte_name, string)) {
@@ -96,7 +97,9 @@
     const HashData *data = _nc_get_hash_info(termcap);
     int hashvalue = data->hash_of(string);
 
-    if (data->table_data[hashvalue] >= 0) {
+    if (hashvalue >= 0
+      && (unsigned) hashvalue < data->table_size
+      && data->table_data[hashvalue] >= 0) {
 	const struct name_table_entry *const table = _nc_get_table(termcap);
 
 	ptr = table + data->table_data[hashvalue];
